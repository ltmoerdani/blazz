import{m as y,u as F,Y as ze,G as N,a1 as ve,a2 as Fe,R as Se,D as Z,r as A,K as Ae,M as L,V as Re,q as de,I as ne,F as re,S as oe,W as we,H as K,U as Ve,o as B,c as j,a as W,t as U,j as q,g as J,n as Y,l as fe,b as G,f as pe,e as $e}from"./app-0c4c5d77.js";import{d as ke,c as V,f as he,e as Pe,u as De,r as _e,b as Be}from"./ProfileModal-d56b99b0.js";import{o as ue,w as Le,t as Ne,i as ie,l as je,a as me,n as We,S as Ue}from"./transition-58e3bd65.js";import{u as X,o as w,f as qe,E as Ke,a as He,A as le,T as ce,i as se,d as Je,N as ae,O as Ye,b as k}from"./keyboard-cedb46ac.js";import{s as Ge}from"./index-508be6f5.js";import{i as Qe}from"./use-tree-walker-5ebe2c29.js";function Q(n,d,l){let o=l.initialDeps??[],e;function a(){var i,t,p,v;let s;l.key&&((i=l.debug)!=null&&i.call(l))&&(s=Date.now());const c=n();if(!(c.length!==o.length||c.some((O,z)=>o[z]!==O)))return e;o=c;let S;if(l.key&&((t=l.debug)!=null&&t.call(l))&&(S=Date.now()),e=d(...c),l.key&&((p=l.debug)!=null&&p.call(l))){const O=Math.round((Date.now()-s)*100)/100,z=Math.round((Date.now()-S)*100)/100,D=z/16,$=(b,I)=>{for(b=String(b);b.length<I;)b=" "+b;return b};console.info(`%c⏱ ${$(z,5)} /${$(O,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*D,120))}deg 100% 31%);`,l==null?void 0:l.key)}return(v=l==null?void 0:l.onChange)==null||v.call(l,e),e}return a.updateDeps=i=>{o=i},a}function be(n,d){if(n===void 0)throw new Error(`Unexpected undefined${d?`: ${d}`:""}`);return n}const Xe=(n,d)=>Math.abs(n-d)<1.01,Ze=(n,d,l)=>{let o;return function(...e){n.clearTimeout(o),o=n.setTimeout(()=>d.apply(this,e),l)}},ge=n=>{const{offsetWidth:d,offsetHeight:l}=n;return{width:d,height:l}},et=n=>n,tt=n=>{const d=Math.max(n.startIndex-n.overscan,0),l=Math.min(n.endIndex+n.overscan,n.count-1),o=[];for(let e=d;e<=l;e++)o.push(e);return o},lt=(n,d)=>{const l=n.scrollElement;if(!l)return;const o=n.targetWindow;if(!o)return;const e=i=>{const{width:t,height:p}=i;d({width:Math.round(t),height:Math.round(p)})};if(e(ge(l)),!o.ResizeObserver)return()=>{};const a=new o.ResizeObserver(i=>{const t=()=>{const p=i[0];if(p!=null&&p.borderBoxSize){const v=p.borderBoxSize[0];if(v){e({width:v.inlineSize,height:v.blockSize});return}}e(ge(l))};n.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(t):t()});return a.observe(l,{box:"border-box"}),()=>{a.unobserve(l)}},xe={passive:!0},ye=typeof window>"u"?!0:"onscrollend"in window,nt=(n,d)=>{const l=n.scrollElement;if(!l)return;const o=n.targetWindow;if(!o)return;let e=0;const a=n.options.useScrollendEvent&&ye?()=>{}:Ze(o,()=>{d(e,!1)},n.options.isScrollingResetDelay),i=s=>()=>{const{horizontal:c,isRtl:m}=n.options;e=c?l.scrollLeft*(m&&-1||1):l.scrollTop,a(),d(e,s)},t=i(!0),p=i(!1);p(),l.addEventListener("scroll",t,xe);const v=n.options.useScrollendEvent&&ye;return v&&l.addEventListener("scrollend",p,xe),()=>{l.removeEventListener("scroll",t),v&&l.removeEventListener("scrollend",p)}},ot=(n,d,l)=>{if(d!=null&&d.borderBoxSize){const o=d.borderBoxSize[0];if(o)return Math.round(o[l.options.horizontal?"inlineSize":"blockSize"])}return n[l.options.horizontal?"offsetWidth":"offsetHeight"]},it=(n,{adjustments:d=0,behavior:l},o)=>{var e,a;const i=n+d;(a=(e=o.scrollElement)==null?void 0:e.scrollTo)==null||a.call(e,{[o.options.horizontal?"left":"top"]:i,behavior:l})};class at{constructor(d){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let l=null;const o=()=>l||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:l=new this.targetWindow.ResizeObserver(e=>{e.forEach(a=>{const i=()=>{this._measureElement(a.target,a)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()})}));return{disconnect:()=>{var e;(e=o())==null||e.disconnect(),l=null},observe:e=>{var a;return(a=o())==null?void 0:a.observe(e,{box:"border-box"})},unobserve:e=>{var a;return(a=o())==null?void 0:a.unobserve(e)}}})(),this.range=null,this.setOptions=l=>{Object.entries(l).forEach(([o,e])=>{typeof e>"u"&&delete l[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:et,rangeExtractor:tt,onChange:()=>{},measureElement:ot,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...l}},this.notify=l=>{var o,e;(e=(o=this.options).onChange)==null||e.call(o,this,l)},this.maybeNotify=Q(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),l=>{this.notify(l)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(l=>l()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var l;const o=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==o){if(this.cleanup(),!o){this.maybeNotify();return}this.scrollElement=o,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((l=this.scrollElement)==null?void 0:l.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=a,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(l,o)=>{const e=new Map,a=new Map;for(let i=o-1;i>=0;i--){const t=l[i];if(e.has(t.lane))continue;const p=a.get(t.lane);if(p==null||t.end>p.end?a.set(t.lane,t):t.end<p.end&&e.set(t.lane,!0),e.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,t)=>i.end===t.end?i.index-t.index:i.end-t.end)[0]:void 0},this.getMeasurementOptions=Q(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(l,o,e,a,i)=>(this.pendingMeasuredCacheIndexes=[],{count:l,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i}),{key:!1}),this.getMeasurements=Q(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:l,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i},t)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(s=>{this.itemSizeCache.set(s.key,s.size)}));const p=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,p);for(let s=p;s<l;s++){const c=a(s),m=this.options.lanes===1?v[s-1]:this.getFurthestMeasurement(v,s),S=m?m.end+this.options.gap:o+e,O=t.get(c),z=typeof O=="number"?O:this.options.estimateSize(s),D=S+z,$=m?m.lane:s%this.options.lanes;v[s]={index:s,start:S,size:z,end:D,key:c,lane:$}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Q(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(l,o,e,a)=>this.range=l.length>0&&o>0?st({measurements:l,outerSize:o,scrollOffset:e,lanes:a}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Q(()=>{let l=null,o=null;const e=this.calculateRange();return e&&(l=e.startIndex,o=e.endIndex),this.maybeNotify.updateDeps([this.isScrolling,l,o]),[this.options.rangeExtractor,this.options.overscan,this.options.count,l,o]},(l,o,e,a,i)=>a===null||i===null?[]:l({startIndex:a,endIndex:i,overscan:o,count:e}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=l=>{const o=this.options.indexAttribute,e=l.getAttribute(o);return e?parseInt(e,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(l,o)=>{const e=this.indexFromElement(l),a=this.measurementsCache[e];if(!a)return;const i=a.key,t=this.elementsCache.get(i);t!==l&&(t&&this.observer.unobserve(t),this.observer.observe(l),this.elementsCache.set(i,l)),l.isConnected&&this.resizeItem(e,this.options.measureElement(l,o,this))},this.resizeItem=(l,o)=>{const e=this.measurementsCache[l];if(!e)return;const a=this.itemSizeCache.get(e.key)??e.size,i=o-a;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,i,this):e.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!1))},this.measureElement=l=>{if(!l){this.elementsCache.forEach((o,e)=>{o.isConnected||(this.observer.unobserve(o),this.elementsCache.delete(e))});return}this._measureElement(l,void 0)},this.getVirtualItems=Q(()=>[this.getVirtualIndexes(),this.getMeasurements()],(l,o)=>{const e=[];for(let a=0,i=l.length;a<i;a++){const t=l[a],p=o[t];e.push(p)}return e},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=l=>{const o=this.getMeasurements();if(o.length!==0)return be(o[Ie(0,o.length-1,e=>be(o[e]).start,l)])},this.getOffsetForAlignment=(l,o,e=0)=>{const a=this.getSize(),i=this.getScrollOffset();o==="auto"&&(o=l>=i+a?"end":"start"),o==="center"?l+=(e-a)/2:o==="end"&&(l-=a);const t=this.getTotalSize()+this.options.scrollMargin-a;return Math.max(Math.min(t,l),0)},this.getOffsetForIndex=(l,o="auto")=>{l=Math.max(0,Math.min(l,this.options.count-1));const e=this.measurementsCache[l];if(!e)return;const a=this.getSize(),i=this.getScrollOffset();if(o==="auto")if(e.end>=i+a-this.options.scrollPaddingEnd)o="end";else if(e.start<=i+this.options.scrollPaddingStart)o="start";else return[i,o];const t=o==="end"?e.end+this.options.scrollPaddingEnd:e.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(t,o,e.size),o]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(l,{align:o="start",behavior:e}={})=>{e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(l,o),{adjustments:void 0,behavior:e})},this.scrollToIndex=(l,{align:o="auto",behavior:e}={})=>{e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),l=Math.max(0,Math.min(l,this.options.count-1));let a=0;const i=10,t=v=>{if(!this.targetWindow)return;const s=this.getOffsetForIndex(l,v);if(!s){console.warn("Failed to get offset for index:",l);return}const[c,m]=s;this._scrollToOffset(c,{adjustments:void 0,behavior:e}),this.targetWindow.requestAnimationFrame(()=>{const S=this.getScrollOffset(),O=this.getOffsetForIndex(l,m);if(!O){console.warn("Failed to get offset for index:",l);return}Xe(O[0],S)||p(m)})},p=v=>{this.targetWindow&&(a++,a<i?this.targetWindow.requestAnimationFrame(()=>t(v)):console.warn(`Failed to scroll to index ${l} after ${i} attempts.`))};t(o)},this.scrollBy=(l,{behavior:o}={})=>{o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+l,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var l;const o=this.getMeasurements();let e;if(o.length===0)e=this.options.paddingStart;else if(this.options.lanes===1)e=((l=o[o.length-1])==null?void 0:l.end)??0;else{const a=Array(this.options.lanes).fill(null);let i=o.length-1;for(;i>=0&&a.some(t=>t===null);){const t=o[i];a[t.lane]===null&&(a[t.lane]=t.end),i--}e=Math.max(...a.filter(t=>t!==null))}return Math.max(e-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(l,{adjustments:o,behavior:e})=>{this.options.scrollToFn(l,{behavior:e,adjustments:o},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(d)}}const Ie=(n,d,l,o)=>{for(;n<=d;){const e=(n+d)/2|0,a=l(e);if(a<o)n=e+1;else if(a>o)d=e-1;else return e}return n>0?n-1:0};function st({measurements:n,outerSize:d,scrollOffset:l,lanes:o}){const e=n.length-1,a=p=>n[p].start;if(n.length<=o)return{startIndex:0,endIndex:e};let i=Ie(0,e,a,l),t=i;if(o===1)for(;t<e&&n[t].end<l+d;)t++;else if(o>1){const p=Array(o).fill(0);for(;t<e&&p.some(s=>s<l+d);){const s=n[t];p[s.lane]=s.end,t++}const v=Array(o).fill(l+d);for(;i>=0&&v.some(s=>s>=l);){const s=n[i];v[s.lane]=s.start,i--}i=Math.max(0,i-i%o),t=Math.min(e,t+(o-1-t%o))}return{startIndex:i,endIndex:t}}function rt(n){const d=new at(F(n)),l=ze(d),o=d._didMount();return N(()=>F(n).getScrollElement(),e=>{e&&d._willUpdate()},{immediate:!0}),N(()=>F(n),e=>{d.setOptions({...e,onChange:(a,i)=>{var t;ve(l),(t=e.onChange)==null||t.call(e,a,i)}}),d._willUpdate(),ve(l)},{immediate:!0}),Fe(o),l}function ut(n){return rt(y(()=>({observeElementRect:lt,observeElementOffset:nt,scrollToFn:it,...F(n)})))}function dt(){let n=ue();return Se(()=>n.dispose()),n}function ct(){let n=dt();return d=>{n.dispose(),n.nextFrame(d)}}var Ce=(n=>(n[n.Left=0]="Left",n[n.Right=2]="Right",n))(Ce||{});function vt(n,d){return n===d}var ft=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(ft||{}),pt=(n=>(n[n.Single=0]="Single",n[n.Multi=1]="Multi",n))(pt||{}),ht=(n=>(n[n.Pointer=0]="Pointer",n[n.Focus=1]="Focus",n[n.Other=2]="Other",n))(ht||{});let Ee=Symbol("ComboboxContext");function ee(n){let d=we(Ee,null);if(d===null){let l=new Error(`<${n} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,ee),l}return d}let Me=Symbol("VirtualContext"),mt=Z({name:"VirtualProvider",setup(n,{slots:d}){let l=ee("VirtualProvider"),o=y(()=>{let t=w(l.optionsRef);if(!t)return{start:0,end:0};let p=window.getComputedStyle(t);return{start:parseFloat(p.paddingBlockStart||p.paddingTop),end:parseFloat(p.paddingBlockEnd||p.paddingBottom)}}),e=ut(y(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:l.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return w(l.optionsRef)},overscan:12}))),a=y(()=>{var t;return(t=l.virtual.value)==null?void 0:t.options}),i=A(0);return N([a],()=>{i.value+=1}),Re(Me,l.virtual.value?e:null),()=>[ne("div",{style:{position:"relative",width:"100%",height:`${e.value.getTotalSize()}px`},ref:t=>{if(t){if(typeof process<"u"&&{}.JEST_WORKER_ID!==void 0||l.activationTrigger.value===0)return;l.activeOptionIndex.value!==null&&l.virtual.value.options.length>l.activeOptionIndex.value&&e.value.scrollToIndex(l.activeOptionIndex.value)}}},e.value.getVirtualItems().map(t=>Ve(d.default({option:l.virtual.value.options[t.index],open:l.comboboxState.value===0})[0],{key:`${i.value}-${t.index}`,"data-index":t.index,"aria-setsize":l.virtual.value.options.length,"aria-posinset":t.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${t.start}px)`,overflowAnchor:"none"}})))]}}),bt=Z({name:"Combobox",emits:{"update:modelValue":n=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(n,{slots:d,attrs:l,emit:o}){let e=A(1),a=A(null),i=A(null),t=A(null),p=A(null),v=A({static:!1,hold:!1}),s=A([]),c=A(null),m=A(2),S=A(!1);function O(r=f=>f){let f=c.value!==null?s.value[c.value]:null,g=r(s.value.slice()),x=g.length>0&&g[0].dataRef.order.value!==null?g.sort((T,_)=>T.dataRef.order.value-_.dataRef.order.value):Ye(g,T=>w(T.dataRef.domRef)),M=f?x.indexOf(f):null;return M===-1&&(M=null),{options:x,activeOptionIndex:M}}let z=y(()=>n.multiple?1:0),D=y(()=>n.nullable),[$,b]=ke(y(()=>n.modelValue),r=>o("update:modelValue",r),y(()=>n.defaultValue)),I=y(()=>$.value===void 0?X(z.value,{1:[],0:void 0}):$.value),P=null,h=null;function C(r){return X(z.value,{0(){return b==null?void 0:b(r)},1:()=>{let f=L(u.value.value).slice(),g=L(r),x=f.findIndex(M=>u.compare(g,L(M)));return x===-1?f.push(g):f.splice(x,1),b==null?void 0:b(f)}})}let E=y(()=>{});N([E],([r],[f])=>{if(u.virtual.value&&r&&f&&c.value!==null){let g=r.indexOf(f[c.value]);g!==-1?c.value=g:c.value=null}});let u={comboboxState:e,value:I,mode:z,compare(r,f){if(typeof n.by=="string"){let g=n.by;return(r==null?void 0:r[g])===(f==null?void 0:f[g])}return n.by===null?vt(r,f):n.by(r,f)},calculateIndex(r){return u.virtual.value?n.by===null?u.virtual.value.options.indexOf(r):u.virtual.value.options.findIndex(f=>u.compare(f,r)):s.value.findIndex(f=>u.compare(f.dataRef.value,r))},defaultValue:y(()=>n.defaultValue),nullable:D,immediate:y(()=>!1),virtual:y(()=>null),inputRef:i,labelRef:a,buttonRef:t,optionsRef:p,disabled:y(()=>n.disabled),options:s,change(r){b(r)},activeOptionIndex:y(()=>{if(S.value&&c.value===null&&(u.virtual.value?u.virtual.value.options.length>0:s.value.length>0)){if(u.virtual.value){let f=u.virtual.value.options.findIndex(g=>{var x;return!((x=u.virtual.value)!=null&&x.disabled(g))});if(f!==-1)return f}let r=s.value.findIndex(f=>!f.dataRef.disabled);if(r!==-1)return r}return c.value}),activationTrigger:m,optionsPropsRef:v,closeCombobox(){S.value=!1,!n.disabled&&e.value!==1&&(e.value=1,c.value=null)},openCombobox(){if(S.value=!0,!n.disabled&&e.value!==0){if(u.value.value){let r=u.calculateIndex(u.value.value);r!==-1&&(c.value=r)}e.value=0}},setActivationTrigger(r){m.value=r},goToOption(r,f,g){S.value=!1,P!==null&&cancelAnimationFrame(P),P=requestAnimationFrame(()=>{if(n.disabled||p.value&&!v.value.static&&e.value===1)return;if(u.virtual.value){c.value=r===V.Specific?f:he({focus:r},{resolveItems:()=>u.virtual.value.options,resolveActiveIndex:()=>{var T,_;return(_=(T=u.activeOptionIndex.value)!=null?T:u.virtual.value.options.findIndex(H=>{var te;return!((te=u.virtual.value)!=null&&te.disabled(H))}))!=null?_:null},resolveDisabled:T=>u.virtual.value.disabled(T),resolveId(){throw new Error("Function not implemented.")}}),m.value=g??2;return}let x=O();if(x.activeOptionIndex===null){let T=x.options.findIndex(_=>!_.dataRef.disabled);T!==-1&&(x.activeOptionIndex=T)}let M=r===V.Specific?f:he({focus:r},{resolveItems:()=>x.options,resolveActiveIndex:()=>x.activeOptionIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});c.value=M,m.value=g??2,s.value=x.options})},selectOption(r){let f=s.value.find(x=>x.id===r);if(!f)return;let{dataRef:g}=f;C(g.value)},selectActiveOption(){if(u.activeOptionIndex.value!==null){if(u.virtual.value)C(u.virtual.value.options[u.activeOptionIndex.value]);else{let{dataRef:r}=s.value[u.activeOptionIndex.value];C(r.value)}u.goToOption(V.Specific,u.activeOptionIndex.value)}},registerOption(r,f){let g=Ae({id:r,dataRef:f});if(u.virtual.value){s.value.push(g);return}h&&cancelAnimationFrame(h);let x=O(M=>(M.push(g),M));c.value===null&&u.isSelected(f.value.value)&&(x.activeOptionIndex=x.options.indexOf(g)),s.value=x.options,c.value=x.activeOptionIndex,m.value=2,x.options.some(M=>!w(M.dataRef.domRef))&&(h=requestAnimationFrame(()=>{let M=O();s.value=M.options,c.value=M.activeOptionIndex}))},unregisterOption(r,f){if(P!==null&&cancelAnimationFrame(P),f&&(S.value=!0),u.virtual.value){s.value=s.value.filter(x=>x.id!==r);return}let g=O(x=>{let M=x.findIndex(T=>T.id===r);return M!==-1&&x.splice(M,1),x});s.value=g.options,c.value=g.activeOptionIndex,m.value=2},isSelected(r){return X(z.value,{0:()=>u.compare(L(u.value.value),L(r)),1:()=>L(u.value.value).some(f=>u.compare(L(f),L(r)))})},isActive(r){return c.value===u.calculateIndex(r)}};Le([i,t,p],()=>u.closeCombobox(),y(()=>e.value===0)),Re(Ee,u),Ne(y(()=>X(e.value,{0:ie.Open,1:ie.Closed})));let R=y(()=>{var r;return(r=w(i))==null?void 0:r.closest("form")});return de(()=>{N([R],()=>{if(!R.value||n.defaultValue===void 0)return;function r(){u.change(n.defaultValue)}return R.value.addEventListener("reset",r),()=>{var f;(f=R.value)==null||f.removeEventListener("reset",r)}},{immediate:!0})}),()=>{var r,f,g;let{name:x,disabled:M,form:T,..._}=n,H={open:e.value===0,disabled:M,activeIndex:u.activeOptionIndex.value,activeOption:u.activeOptionIndex.value===null?null:u.virtual.value?u.virtual.value.options[(r=u.activeOptionIndex.value)!=null?r:0]:(g=(f=u.options.value[u.activeOptionIndex.value])==null?void 0:f.dataRef.value)!=null?g:null,value:I.value};return ne(re,[...x!=null&&I.value!=null?Pe({[x]:I.value}).map(([te,Te])=>ne(qe,Ke({features:He.Hidden,key:te,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:T,disabled:M,name:te,value:Te}))):[],le({theirProps:{...l,...ce(_,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:H,slots:d,attrs:l,name:"Combobox"})])}}}),gt=Z({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(n,{attrs:d,slots:l,expose:o}){var e;let a=(e=n.id)!=null?e:`headlessui-combobox-button-${se()}`,i=ee("ComboboxButton");o({el:i.buttonRef,$el:i.buttonRef});function t(s){i.disabled.value||(i.comboboxState.value===0?i.closeCombobox():(s.preventDefault(),i.openCombobox()),K(()=>{var c;return(c=w(i.inputRef))==null?void 0:c.focus({preventScroll:!0})}))}function p(s){switch(s.key){case k.ArrowDown:s.preventDefault(),s.stopPropagation(),i.comboboxState.value===1&&i.openCombobox(),K(()=>{var c;return(c=i.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return;case k.ArrowUp:s.preventDefault(),s.stopPropagation(),i.comboboxState.value===1&&(i.openCombobox(),K(()=>{i.value.value||i.goToOption(V.Last)})),K(()=>{var c;return(c=i.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return;case k.Escape:if(i.comboboxState.value!==0)return;s.preventDefault(),i.optionsRef.value&&!i.optionsPropsRef.value.static&&s.stopPropagation(),i.closeCombobox(),K(()=>{var c;return(c=i.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return}}let v=Ge(y(()=>({as:n.as,type:d.type})),i.buttonRef);return()=>{var s,c;let m={open:i.comboboxState.value===0,disabled:i.disabled.value,value:i.value.value},{...S}=n,O={ref:i.buttonRef,id:a,type:v.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(s=w(i.optionsRef))==null?void 0:s.id,"aria-expanded":i.comboboxState.value===0,"aria-labelledby":i.labelRef.value?[(c=w(i.labelRef))==null?void 0:c.id,a].join(" "):void 0,disabled:i.disabled.value===!0?!0:void 0,onKeydown:p,onClick:t};return le({ourProps:O,theirProps:S,slot:m,attrs:d,slots:l,name:"ComboboxButton"})}}}),xt=Z({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:n=>!0},setup(n,{emit:d,attrs:l,slots:o,expose:e}){var a;let i=(a=n.id)!=null?a:`headlessui-combobox-input-${se()}`,t=ee("ComboboxInput"),p=y(()=>Je(w(t.inputRef))),v={value:!1};e({el:t.inputRef,$el:t.inputRef});function s(){t.change(null);let h=w(t.optionsRef);h&&(h.scrollTop=0),t.goToOption(V.Nothing)}let c=y(()=>{var h;let C=t.value.value;return w(t.inputRef)?typeof n.displayValue<"u"&&C!==void 0?(h=n.displayValue(C))!=null?h:"":typeof C=="string"?C:"":""});de(()=>{N([c,t.comboboxState,p],([h,C],[E,u])=>{if(v.value)return;let R=w(t.inputRef);R&&((u===0&&C===1||h!==E)&&(R.value=h),requestAnimationFrame(()=>{var r;if(v.value||!R||((r=p.value)==null?void 0:r.activeElement)!==R)return;let{selectionStart:f,selectionEnd:g}=R;Math.abs((g??0)-(f??0))===0&&f===0&&R.setSelectionRange(R.value.length,R.value.length)}))},{immediate:!0}),N([t.comboboxState],([h],[C])=>{if(h===0&&C===1){if(v.value)return;let E=w(t.inputRef);if(!E)return;let u=E.value,{selectionStart:R,selectionEnd:r,selectionDirection:f}=E;E.value="",E.value=u,f!==null?E.setSelectionRange(R,r,f):E.setSelectionRange(R,r)}})});let m=A(!1);function S(){m.value=!0}function O(){ue().nextFrame(()=>{m.value=!1})}let z=ct();function D(h){switch(v.value=!0,z(()=>{v.value=!1}),h.key){case k.Enter:if(v.value=!1,t.comboboxState.value!==0||m.value)return;if(h.preventDefault(),h.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case k.ArrowDown:return v.value=!1,h.preventDefault(),h.stopPropagation(),X(t.comboboxState.value,{0:()=>t.goToOption(V.Next),1:()=>t.openCombobox()});case k.ArrowUp:return v.value=!1,h.preventDefault(),h.stopPropagation(),X(t.comboboxState.value,{0:()=>t.goToOption(V.Previous),1:()=>{t.openCombobox(),K(()=>{t.value.value||t.goToOption(V.Last)})}});case k.Home:if(h.shiftKey)break;return v.value=!1,h.preventDefault(),h.stopPropagation(),t.goToOption(V.First);case k.PageUp:return v.value=!1,h.preventDefault(),h.stopPropagation(),t.goToOption(V.First);case k.End:if(h.shiftKey)break;return v.value=!1,h.preventDefault(),h.stopPropagation(),t.goToOption(V.Last);case k.PageDown:return v.value=!1,h.preventDefault(),h.stopPropagation(),t.goToOption(V.Last);case k.Escape:if(v.value=!1,t.comboboxState.value!==0)return;h.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&h.stopPropagation(),t.nullable.value&&t.mode.value===0&&t.value.value===null&&s(),t.closeCombobox();break;case k.Tab:if(v.value=!1,t.comboboxState.value!==0)return;t.mode.value===0&&t.activationTrigger.value!==1&&t.selectActiveOption(),t.closeCombobox();break}}function $(h){d("change",h),t.nullable.value&&t.mode.value===0&&h.target.value===""&&s(),t.openCombobox()}function b(h){var C,E,u;let R=(C=h.relatedTarget)!=null?C:me.find(r=>r!==h.currentTarget);if(v.value=!1,!((E=w(t.optionsRef))!=null&&E.contains(R))&&!((u=w(t.buttonRef))!=null&&u.contains(R))&&t.comboboxState.value===0)return h.preventDefault(),t.mode.value===0&&(t.nullable.value&&t.value.value===null?s():t.activationTrigger.value!==1&&t.selectActiveOption()),t.closeCombobox()}function I(h){var C,E,u;let R=(C=h.relatedTarget)!=null?C:me.find(r=>r!==h.currentTarget);(E=w(t.buttonRef))!=null&&E.contains(R)||(u=w(t.optionsRef))!=null&&u.contains(R)||t.disabled.value||t.immediate.value&&t.comboboxState.value!==0&&(t.openCombobox(),ue().nextFrame(()=>{t.setActivationTrigger(1)}))}let P=y(()=>{var h,C,E,u;return(u=(E=(C=n.defaultValue)!=null?C:t.defaultValue.value!==void 0?(h=n.displayValue)==null?void 0:h.call(n,t.defaultValue.value):null)!=null?E:t.defaultValue.value)!=null?u:""});return()=>{var h,C,E,u,R,r,f;let g={open:t.comboboxState.value===0},{displayValue:x,onChange:M,...T}=n,_={"aria-controls":(h=t.optionsRef.value)==null?void 0:h.id,"aria-expanded":t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null?void 0:t.virtual.value?(C=t.options.value.find(H=>!t.virtual.value.disabled(H.dataRef.value)&&t.compare(H.dataRef.value,t.virtual.value.options[t.activeOptionIndex.value])))==null?void 0:C.id:(E=t.options.value[t.activeOptionIndex.value])==null?void 0:E.id,"aria-labelledby":(r=(u=w(t.labelRef))==null?void 0:u.id)!=null?r:(R=w(t.buttonRef))==null?void 0:R.id,"aria-autocomplete":"list",id:i,onCompositionstart:S,onCompositionend:O,onKeydown:D,onInput:$,onFocus:I,onBlur:b,role:"combobox",type:(f=l.type)!=null?f:"text",tabIndex:0,ref:t.inputRef,defaultValue:P.value,disabled:t.disabled.value===!0?!0:void 0};return le({ourProps:_,theirProps:T,slot:g,attrs:l,slots:o,features:ae.RenderStrategy|ae.Static,name:"ComboboxInput"})}}}),yt=Z({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(n,{attrs:d,slots:l,expose:o}){let e=ee("ComboboxOptions"),a=`headlessui-combobox-options-${se()}`;o({el:e.optionsRef,$el:e.optionsRef}),oe(()=>{e.optionsPropsRef.value.static=n.static}),oe(()=>{e.optionsPropsRef.value.hold=n.hold});let i=je(),t=y(()=>i!==null?(i.value&ie.Open)===ie.Open:e.comboboxState.value===0);Qe({container:y(()=>w(e.optionsRef)),enabled:y(()=>e.comboboxState.value===0),accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});function p(v){v.preventDefault()}return()=>{var v,s,c;let m={open:e.comboboxState.value===0},S={"aria-labelledby":(c=(v=w(e.labelRef))==null?void 0:v.id)!=null?c:(s=w(e.buttonRef))==null?void 0:s.id,id:a,ref:e.optionsRef,role:"listbox","aria-multiselectable":e.mode.value===1?!0:void 0,onMousedown:p},O=ce(n,["hold"]);return le({ourProps:S,theirProps:O,slot:m,attrs:d,slots:e.virtual.value&&e.comboboxState.value===0?{...l,default:()=>[ne(mt,{},l.default)]}:l,features:ae.RenderStrategy|ae.Static,visible:t.value,name:"ComboboxOptions"})}}}),Oe=Z({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(n,{slots:d,attrs:l,expose:o}){let e=ee("ComboboxOption"),a=`headlessui-combobox-option-${se()}`,i=A(null),t=y(()=>n.disabled);o({el:i,$el:i});let p=y(()=>{var b;return e.virtual.value?e.activeOptionIndex.value===e.calculateIndex(n.value):e.activeOptionIndex.value===null?!1:((b=e.options.value[e.activeOptionIndex.value])==null?void 0:b.id)===a}),v=y(()=>e.isSelected(n.value)),s=we(Me,null),c=y(()=>({disabled:n.disabled,value:n.value,domRef:i,order:y(()=>n.order)}));de(()=>e.registerOption(a,c)),Se(()=>e.unregisterOption(a,p.value)),oe(()=>{let b=w(i);b&&(s==null||s.value.measureElement(b))}),oe(()=>{e.comboboxState.value===0&&p.value&&(e.virtual.value||e.activationTrigger.value!==0&&K(()=>{var b,I;return(I=(b=w(i))==null?void 0:b.scrollIntoView)==null?void 0:I.call(b,{block:"nearest"})}))});function m(b){b.preventDefault(),b.button===Ce.Left&&(t.value||(e.selectOption(a),We()||requestAnimationFrame(()=>{var I;return(I=w(e.inputRef))==null?void 0:I.focus({preventScroll:!0})}),e.mode.value===0&&e.closeCombobox()))}function S(){var b;if(n.disabled||(b=e.virtual.value)!=null&&b.disabled(n.value))return e.goToOption(V.Nothing);let I=e.calculateIndex(n.value);e.goToOption(V.Specific,I)}let O=De();function z(b){O.update(b)}function D(b){var I;if(!O.wasMoved(b)||n.disabled||(I=e.virtual.value)!=null&&I.disabled(n.value)||p.value)return;let P=e.calculateIndex(n.value);e.goToOption(V.Specific,P,0)}function $(b){var I;O.wasMoved(b)&&(n.disabled||(I=e.virtual.value)!=null&&I.disabled(n.value)||p.value&&(e.optionsPropsRef.value.hold||e.goToOption(V.Nothing)))}return()=>{let{disabled:b}=n,I={active:p.value,selected:v.value,disabled:b},P={id:a,ref:i,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":v.value,disabled:void 0,onMousedown:m,onFocus:S,onPointerenter:z,onMouseenter:z,onPointermove:D,onMousemove:D,onPointerleave:$,onMouseleave:$},h=ce(n,["order","value"]);return le({ourProps:P,theirProps:h,slot:I,attrs:l,slots:d,name:"ComboboxOption"})}}});const Ot={for:"name",class:"block text-sm leading-6 text-gray-900"},St={class:"relative"},Rt={key:0,class:"relative cursor-default select-none py-2 px-4 text-gray-700"},wt={key:1,class:"relative cursor-default select-none py-2 px-4 text-gray-700"},It={key:0,class:"form-error text-[#b91c1c] text-xs"},At={__name:"FormSelectCombo",props:{modelValue:Object,name:String,className:String,placeholder:{type:String,default:"Select option"},options:{type:Array,default:()=>[]},loadOptions:Function,createOption:Function,error:String},emits:["update:modelValue"],setup(n,{emit:d}){const l=d,o=n,e=A([]),a=A(!1),i=y(()=>t.value===""?null:{missing:!0,label:t.value});let t=A("");N(t,s=>{o.loadOptions&&(a.value=!0,o.loadOptions(s,c=>{e.value=Object.values(c).map(m=>({value:m.id,label:`${m.first_name} ${m.last_name}`})),a.value=!1}))},{immediate:!0});let p=y(()=>t.value===""?e.value:e.value.filter(s=>s.label.toLowerCase().replace(/\s+/g,"").includes(t.value.toLowerCase().replace(/\s+/g,""))));function v(s){l("update:modelValue",s),o.createOption&&(s!=null&&s.missing)&&(a.value=!0,o.createOption(s,c=>{l("update:modelValue",c),a.value=!1}))}return(s,c)=>(B(),j("div",{class:Y(n.className)},[W("label",Ot,U(n.name),1),W("div",null,[q(F(bt),{by:"value","model-value":o.modelValue,"onUpdate:modelValue":v},{default:J(()=>[W("div",St,[W("div",{class:Y(["relative w-full cursor-default overflow-hidden rounded-lg bg-white text-left ring-1 shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 focus-visible:ring-offset-teal-300 sm:text-sm",n.error?"ring-[#b91c1c]":"ring-gray-300"])},[q(F(xt),{class:"w-full border-none py-2 pl-3 pr-10 text-sm leading-5 text-gray-900 focus:outline-none focus:ring-0",displayValue:m=>m==null?void 0:m.label,onChange:c[0]||(c[0]=m=>fe(t)?t.value=m.target.value:t=m.target.value)},null,8,["displayValue"]),q(F(gt),{class:"absolute inset-y-0 right-0 flex items-center pr-2"},{default:J(()=>[q(F(_e),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1})],2),q(F(Ue),{leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",onAfterLeave:c[1]||(c[1]=m=>fe(t)?t.value="":t="")},{default:J(()=>[q(F(yt),{class:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:J(()=>[F(p).length===0&&!a.value&&!i.value&&!o.createOption?(B(),j("div",Rt,U(s.$t("Nothing found")),1)):G("",!0),a.value?(B(),j("div",wt,U(s.$t("Loading...")),1)):G("",!0),a.value?G("",!0):(B(),j(re,{key:2},[i.value&&!F(p).length&&o.createOption?(B(),pe(F(Oe),{key:0,as:"template",value:i.value},{default:J(({active:m})=>[W("li",{class:Y(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-teal-600 text-white":m,"text-gray-900":!m}])},U(s.$t("Create"))+' "'+U(i.value.label)+'" ',3)]),_:1},8,["value"])):G("",!0),(B(!0),j(re,null,$e(F(p),m=>(B(),pe(F(Oe),{as:"template",key:m.value,value:m},{default:J(({selected:S,active:O})=>[W("li",{class:Y(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-teal-600 text-white":O,"text-gray-900":!O}])},[W("span",{class:Y(["block truncate",{"font-medium":S,"font-normal":!S}])},U(m.label),3),S?(B(),j("span",{key:0,class:Y(["absolute inset-y-0 left-0 flex items-center pl-3",{"text-white":O,"text-teal-600":!O}])},[q(F(Be),{class:"h-5 w-5","aria-hidden":"true"})],2)):G("",!0)],2)]),_:2},1032,["value"]))),128))],64))]),_:1})]),_:1})])]),_:1},8,["model-value"])]),n.error?(B(),j("div",It,U(n.error),1)):G("",!0)],2))}};export{At as _};
